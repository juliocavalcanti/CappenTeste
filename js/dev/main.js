//Modal Navigation Control
function showModalNav(){
	$(".modal-navigation").fadeIn('slow');
}
function hideModalNav(){
	$(".modal-navigation").fadeOut('slow');
}

//Modal Form Response Control
function showModalFormResponse(){
	$(".modal-form-response").fadeIn('slow');
}
function hideModalFormResponse(){
	$(".modal-form-response").fadeOut('slow');
	$('.form-response').html("");
}

$(function ($) {

    //Detecting viewport dimension
    var vH = $(window).height();
    var vW = $(window).width();
    var introImgH = $('#intro img').height();
    var servicosContentH = $('#servicos .content').height()+20;
    var empresaImageH = $('#empresa .image').height();

    $(window).resize(function() {
    	vW = $(window).width();
		introImgH = $('#intro img').height();
		$('#intro').css('height',introImgH);
		if(vW <= 751){
	    	$('body').addClass('mobile');
	    	$('#servicos .image').css('height','auto');
	    	$('#servicos .content').css('height','auto')
	    	$('#empresa .content').css('height',empresaImageH);
	    }else{
	    	$('body').removeClass('mobile');
	    	$('#servicos .image').css('height',servicosContentH);
	    	$('#servicos .image img').css('max-height',servicosContentH);
	    }
	    if(vW >= 752){
	    	$('#empresa .content').css('height',empresaImageH-30);
	    }
	    if(vW <= 400){
	    	$('#parallax-image').attr('data-stellar-background-ratio','0.3');
	    }
    });

    if(vW <= 751){
    	$('#empresa .content').css('height',empresaImageH);
    }else{
    	$('body').removeClass('mobile');
    	$('#servicos .content').css('height',servicosContentH);
    	$('#servicos .image').css('height',servicosContentH);
    	$('#servicos .image img').css('max-height',servicosContentH);
    }

    if(vW >= 752){
    	$('#empresa .content').css('height',empresaImageH-20);
    }

    if(vW <= 400){
    	//$('.parallax-image').attr('data-stellar-background-ratio','3.3');
    }

    //Adjusting Components Spacing based on detected screen resolution
    $('#intro').css('height',introImgH);

    
	//Fontsize Resizing Setup
	$(function ($) {
		$(".intro .vertical-center h1").fitText(1.2, { minFontSize: '22px', maxFontSize: '24px' })
		if ($('body').hasClass('mobile')) {
			$(".intro-carousel .item").fitText(1.2, { minFontSize: '12px', maxFontSize: '14px' })
		}
	});

    //Carousels
	$(".intro-carousel").owlCarousel({
		navigation : false,
		pagination: true,
		responsive: true,
		items: 1,
		autoHeight: true,
		touchDrag: true,
		mouseDrag: true,
		itemsDesktop: [3000,1],
		itemsDesktopSmall: [1440,1],
		itemsTablet:[800,1],
		autoPlay: true
	});

	$(".servicos-carousel").owlCarousel({
		navigation : false,
		pagination: true,
		responsive: true,
		items: 1,
		autoHeight: true,
		touchDrag: true,
		mouseDrag: true,
		itemsDesktop: [3000,1],
		itemsDesktopSmall: [1440,1],
		itemsTablet:[800,1],
		autoPlay: true
	});

	$(".clientes-carousel").owlCarousel({
		navigation : true,
		navigationText: [
	      "<i class='icon-chevron-left icon-white'></i>",
	      "<i class='icon-chevron-right icon-white'></i>"
	      ],
		pagination: false,
		responsive: true,
		items: 6,
		autoHeight: true,
		touchDrag: true,
		mouseDrag: true,
		itemsDesktop: [1000,6],
		itemsDesktopSmall: [700,4],
		itemsTablet:[800,3],
		autoPlay: true
	});

	//Format Select Tag
	$("select").selectBoxIt({ autoWidth: true });
	$("select#uf").selectBoxIt({ defaultText: "UF" });
	
	//Navigation Menu Show/Hide Control
	$(".menu-hidden-btn").on('click', function() {
		showModalNav();
	});
	$(".modal-navigation ul li").click(function() {
		hideModalNav();
	});

	//Navigation Scroll Setup
	var links = $('.nav').find('li[class!="separator"]');
	section = $('.page-section');
    mywindow = $(window);
    htmlbody = $('html,body');

    //Setup waypoints plugin
    section.waypoint(function (event, direction) {
 
        //cache the variable of the data-section attribute associated with each section
        datasection = $(this).attr('data-section');
 
        //If the user scrolls up change the navigation link that has the same data-section attribute as the section to active and 
        //remove the active class from the previous navigation link 
        if (direction === 'down') {
            $('.nav li[data-section="' + datasection + '"]').addClass('active').prev().removeClass('active');
        }
        // else If the user scrolls down change the navigation link that has the same data-section attribute as the section to active and 
        //remove the active class from the next navigation link 
        else {
            $('.nav li[data-section="' + datasection + '"]').addClass('active').next().removeClass('active');
        }
 
    });

    //waypoints doesnt detect the first slide when user scrolls back up to the top so we add this little bit of code, that removes the class 
    //from navigation link slide 2 and adds it to navigation link slide 1. 
    mywindow.scroll(function () {
        if (mywindow.scrollTop() == 0) {
            $('.nav li[data-section="intro"]').addClass('active');
            $('.nav li[data-section="empresa"]').removeClass('active');
        }
    });

    //Create a function that will be passed a slide number and then will scroll to that slide using jquerys animate. The Jquery
    //easing plugin is also used, so we passed in the easing method of 'easeInOutQuint' which is available throught the plugin.
    function goToByScroll(datasection) {
        htmlbody.animate({
            scrollTop: $('.page-section[data-section="' + datasection + '"]').offset().top
        }, 2000, 'easeInOutQuint');
    }

    links.click(function (e) {
        e.preventDefault();
        datasection = $(this).attr('data-section');
        goToByScroll(datasection);
    });

    //Mobile Scroll Setup
    var ua = navigator.userAgent,
  	isMobileWebkit = /WebKit/.test(ua) && /Mobile/.test(ua);

  	if (isMobileWebkit) {
		$('html').addClass('mobile');
	}

	$(function(){
		var iScrollInstance;

		if (isMobileWebkit) {
			iScrollInstance = new iScroll('wrapper');

			$('#scroller').stellar({
				scrollProperty: 'transform',
				positionProperty: 'transform',
				horizontalScrolling: false,
				verticalOffset: 150
			});
		} else {
			$.stellar({
				horizontalScrolling: false,
				verticalOffset: 150
			});
		}
	});

	//Form Validation
	$( "form" ).validate({
		rules: {
			email: {
				required: true
			},
			cidade: {
				required: true
			},
			uf: {
				required: true
			}
		},
		messages: {
			email: {
				required: 'Enter this!'
			}
		},
		errorPlacement: function( error, element ) {
			error.insertAfter( element.parent() );
		}
	});
	$("form").on('submit', function(event) {
		event.preventDefault();
		if(!$('select#uf').val()){
			$('.selectboxit-enabled').addClass('error');
		}else{
			$('.selectboxit-enabled').removeClass('error');
			if($(this).valid()){
				$('.form-response').html("Dados enviados com sucesso!");
				showModalFormResponse();
				setTimeout(function(){
					hideModalFormResponse();
				}, 10000);
			}
		}
	});

	$("input[type=text]").on('change', function(event) {
		if(!$(this).val()){
			$(this).addClass('error');
		}else{
			$(this).removeClass('error');
		}
	});
	$("select").on('change', function(event) {
		if(!$(this).val()){
			$('.selectboxit-enabled').addClass('error');
		}else{
			$('.selectboxit-enabled').removeClass('error');
		}
	});
});
// $(function ($)  : ends